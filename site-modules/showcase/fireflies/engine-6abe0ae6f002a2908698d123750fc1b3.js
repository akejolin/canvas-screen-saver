import i from"../../../web_modules/react-d5feeccd9551fb7f62a2e2573736736e.js";import"../../../web_modules/prop-types-76f17b5f1ab0157dea4931c8b7a2f947.js";import o from"./particles-program-7e51922d8b950a177bd674ef5369ba3b.js";import{clearAllIntervals as r}from"./interval-handler-c2a464ee22e041ce506d89f42f719423.js";class c extends i.Component{constructor(t){super();this.canvas=i.createRef(),this.state={screen:{width:window.innerWidth,height:window.innerHeight,ratio:window.devicePixelRatio||1},context:null,count:0,mostActiveRepo:"",records:[],sinceYesterday:0,week:0},this.particles=[],this.run=this.run.bind(this)}componentWillMount(){this.handleResize(null,null)}componentDidUpdate(t,e,s){e.context!==this.state.context&&e.context===null&&this.run()}componentDidMount(){const t=this.canvas.current.getContext("2d");this.setState({context:t})}componentWillUnmount(){window.removeEventListener("resize",this.handleResize),r()}run(){r();const t=this.state.context;t.save(),t.scale(this.state.screen.ratio,this.state.screen.ratio),t.fillStyle="#000000",t.globalAlpha=.4,t.fillRect(0,0,this.state.screen.width,this.state.screen.height),t.globalAlpha=1,t.restore(),requestAnimationFrame(()=>this.update()),window.addEventListener("resize",this.handleResize.bind(this,!1)),this.startProgram()}handleResize(t,e){const s=window.devicePixelRatio||1,n=window.innerWidth*s,a=window.innerHeight*s;this.setState({screen:{width:n,height:a,ratio:s,size:n>600?"L":"S"}})}update(){const t=this.state.context;t.save(),this.updateObjects(this.particles,"particles"),t.restore(),requestAnimationFrame(()=>this.update())}updateObjects(t,e){let s=0;for(let n of t)n.delete?this[e].splice(s,1):t[s].render(this.state),s++}startProgram(){const t="ðŸ˜œ",e=new o({size:300,position:{x:Math.ceil(this.state.screen.width/2),y:Math.ceil(this.state.screen.height/2-this.state.screen.height*.5)},create:this.createObject.bind(this),text:t,count:2019,id:"counter",ctx:this.state.context,screen:this.state.screen});e.init(this.state,t),this.createObject(e,"particles")}createObject(t,e){this[e].push(t)}render(){return i.createElement(i.Fragment,null,i.createElement("canvas",{style:{display:"block",backgroundColor:"black",color:"white",top:0,bottom:0,left:0,right:0,width:"100vw",height:"100vh"},ref:this.canvas,width:this.state.screen.width,height:this.state.screen.height}))}}export default c;
